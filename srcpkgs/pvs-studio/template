# Template file for 'pvs-studio'
pkgname=pvs-studio
version=7.21.64848.262
revision=1
archs="x86_64"
wrksrc="$pkgname-${version}-${XBPS_MACHINE}"
short_desc="Static code analysis for C and C++"
maintainer="Joseph Benden <joe@benden.us>"
license="custom:Commercial"
homepage="https://www.viva64.com/"
distfiles="http://files.viva64.com/${pkgname}-${version}-x86_64.tgz"
checksum=a0e8bbc50c6fdc8f2112717ad9349e03e6488c8a5a6d337eba530d2265111023
repository="nonfree"
restricted=yes

post_fetch() {
	$XBPS_FETCH_CMD -o ${XBPS_SRCDISTDIR}/${pkgname}-${version}/license.html https://www.viva64.com/en/terms-of-use/
}

do_install() {
	vmkdir usr/bin
	vmkdir usr/share/bash-completion/completions

	vbin bin/pvs-studio
	vbin bin/plog-converter
	vbin bin/pvs-studio-analyzer

	vcopy etc/bash_completion.d/pvs-studio.sh usr/share/bash-completion/completions/pvs-studio

	vlicense ${XBPS_SRCDISTDIR}/${pkgname}-${version}/license.html
}
