# Template file for 'imagescan-plugin-networkscan'
pkgname=imagescan-plugin-networkscan
version=1.1.4
revision=1
archs="i686 x86_64"
_bversion=3.65.0
_dst=ubuntu
_rel=18.04
build_style=fetch
depends="imagescan"
short_desc="Image Scan v3 Plugin for using Epson scanners over network"
maintainer="Giuseppe Fierro <gspe@ae-design.ws>"
license="custom:Proprietary"
homepage="http://support.epson.net/linux/en/imagescanv3.php"

case "${XBPS_TARGET_MACHINE}" in
	x86_64)
		_type=x64
		_arch=amd64
		_hash=bbc171780e079ba65ef7817b3eb7bed419faa1b09080f6ac72cd3731bc3dc930
		;;
	i686)
		_type=x86
		_arch=i386
		_hash=aa7c67a8b6a513bb7f5d0fb952c8bd3cf7d2dfe7fe26c87b745d5f99f5187d49
		;;
esac

distfiles="https://download2.ebz.epson.net/imagescanv3/ubuntu/lts2/deb/${_type}/imagescan-bundle-${_dst}-${_rel}-${_bversion}.${_type}.deb.tar.gz"
checksum=${_hash}

do_extract() {
	bsdtar xzf ${XBPS_SRCDISTDIR}/${pkgname}-${version}/imagescan-bundle-${_dst}-${_rel}-${_bversion}.${_type}.deb.tar.gz
	ar x imagescan-bundle-${_dst}-${_rel}-${_bversion}.${_type}.deb/plugins/${pkgname}_${version}-1epson4${_dst}${_rel}_${_arch}.deb data.tar.xz
	bsdtar xf data.tar.xz
}

do_install() {
	vlicense usr/share/doc/imagescan-plugin-networkscan/COPYING.EPSON.en.txt.gz
	vlicense usr/share/doc/imagescan-plugin-networkscan/COPYING.EPSON.ja.txt.gz
	rm usr/share/doc/imagescan-plugin-networkscan/COPYING.EPSON.en.txt.gz
	rm usr/share/doc/imagescan-plugin-networkscan/COPYING.EPSON.ja.txt.gz

	vcopy usr /
}
